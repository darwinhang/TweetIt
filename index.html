<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640">

    <link rel="stylesheet" href="stylesheets/core.css" media="screen">
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Tweetit by winious</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/winious/TweetIt">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Tweetit</h1>
            <h2>Chrome extension that allows you to easily quote webpage snippets</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/winious/TweetIt/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/winious/TweetIt/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <h1>
<a id="this-is-the-demo-page-for-tweetit" class="anchor" href="#this-is-the-demo-page-for-tweetit" aria-hidden="true"><span class="octicon octicon-link"></span></a>This is the demo page for TweetIt</h1>

<h2>
<a id="about" class="anchor" href="#about" aria-hidden="true"><span class="octicon octicon-link"></span></a>About</h2>

<p>At first I wanted to create a chrome extension that replicated the features found on Medium.com and many other websites. I also wanted to get some experience with chrome extensions before I tackled chrome apps. Anyway, This page also works as a demo site. I was able to extract the core functionality into a module that wasn't reliant on the chrome API so that it could be used in other places. While it needs a bit of fine tuning, it is at least usable.</p>

<h2>
<a id="so-give-it-a-try" class="anchor" href="#so-give-it-a-try" aria-hidden="true"><span class="octicon octicon-link"></span></a>So give it a try</h2>

<p>Select text on this page and you'll see a rather ugly "Tweet It" pop up. Click on it to tweet the highlighted text.</p>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/winious">winious</a> can be found on <a href="https://github.com/winious/TweetIt">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="http://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-59160574-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>
          <script>
            var TweetIt = (function() {
            	
            	var selectedText =  {
            		"quote": '',
            		"url": ''
            	};
            
            	return {
            
            		limitQuote: function(quote){
              		if (quote.length >= 100) {
              			var newQuote =  quote.slice(0, 97);
              			return newQuote + '...'
              		}
              		return quote;
              		},
              
              		selected: function (ev) {
              			var highlighted = window.getSelection();
              			var highlightedText = highlighted.toString();
              			var currentPage = window.location.href;
              			this.removeAnchor();
              
              			if (highlightedText.length <= 0) {
              				return false;
              			} 
              			else {
              				var range = window.getSelection().getRangeAt(0);
              				var tweetAnchor = document.createElement('span');
              				tweetAnchor.setAttribute('id', 'tweet-anchor');
              
              				// bind callback function to module, otherwise the callback
              				// function will be bound to the tweetAnchor
              				var newTweet = this.tweetIt.bind(TweetIt);
              				tweetAnchor.addEventListener('click', newTweet);
              				range.insertNode(tweetAnchor);
              				var what = range.getBoundingClientRect();
              				var left = what.left, bottom = what.bottom;
              				selectedText.quote = highlightedText;
              				selectedText.url = currentPage;
              			}
              			return false;
              		},
              
              		tweetIt: function(ev) {
              			ev.stopPropagation();
              
              			var url = 'https://twitter.com/intent/tweet';
              
              			var quoteText = encodeURIComponent('"' + this.limitQuote(selectedText.quote) + '"');
              			var fullURI = url + '?text=' + quoteText + '&url=' + encodeURIComponent(selectedText.url);
              			window.open(fullURI);
              
              			this.removeAnchor();
              		},
              
              		removeAnchor: function () {
              			var found = false;
              			do {
              				var existingAnchor = document.getElementById('tweet-anchor');
              				if (existingAnchor) {
              					existingAnchor.remove();
              					found = true;
              				} 
              				else {
              					found = false;
              				}
              			} while (found);
              			return false;
              		}
              	}
              })();
              
              document.body.addEventListener('click' , function(){
              	TweetIt.selected();
              });
          </script>

  </body>
</html>
